<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.png">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="http://localhost:3000/styles.css">
	<title>Assignment 3</title>
</head>

<body>
	<div class='container-fluid'>
		<header class='header'>
			<h1>UltraChat Online</h1>
		</header>
	</div>

	<div class='space'></div>

	<div class='chat-container'>

		<div class='container'>

			<div class='user-display' id='users'>
				User_0
			</div>

			<div class='row'>
				<div class='col-sm'>
					<div class="scrollbars">
						<ul id="messages"></ul>
					</div>
				</div>
			</div>

		</div>

		<form>
			<input id="m" autocomplete="off" type='text' placeholder="Type a message..." />
			<button>Send</button>
		</form>

	</div>
</body>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
$(function() {
	var socket = io();

	$('form').submit(function(e) {
		e.preventDefault();

		if ($('#m').val() != '') {
			socket.emit('message', $('#m').val());
			$('#m').val('');
		}

		return false;
	});

	socket.on("connect", function(users) {
		$("#users").val('');

		$.each(users, function(name) {
			$('#users').append("" + name + "");
		});

		socket.emit("connect", name);
	});

	socket.on("disconnect", function() {
		$("#msgs").append("The server is not available");
	});

	socket.on('message', function(userId, msg) {
		$('#messages').append("" + msg + "");
		$("#m").append("" + userId + " says: " + msg + "");
	});

	socket.on("update", function(msg) {
		$("#msgs").append("" + msg + "");
	})

	socket.on("update-users", function(users) {
		$("#users").empty();

		$.each(users, function(clientid, name) {
			$('#users').append("" + name + "");
		});
	});
});

</script>

</html>
